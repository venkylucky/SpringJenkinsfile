pipeline {

    agent any
    
    environment {
      
     dockerhub_repo = 'venkylucky115/petclinic'
      
    }

    stages {
        stage('Setup') {
            steps {
              
              git credentialsId: 'github', url: ' https://github.com/venkylucky/spring-petclinic.git'
                
                
                  }
         
                       }
        stage('Selenium Test Suite') {
            
            steps {
                  sh '''#!/bin/bash -l
		  jdk = tool name: 'JAVA_HOME'
                 env.JAVA_HOME = "${jdk}"

                  echo "jdk installation path is: ${jdk}"
		  pwd
		   mvn --version
                   mvn clean install -f pom.xml
                   '''      
            }
          }
  }
            post {
	             always{ 
               sh  ''' 
                ls -ltr
                  
             # junit '**/	target/surefire-reports/testng-results.xml'
	          '''
              junit  '/var/lib/jenkins/workspace/free/target/surefire-reports/*.xml'
                
                       }
        failure {
            echo "Error occurred. --> ${currentBuild.fullDisplayName} --> ${env.BUILD_URL}"
                }
                 }
        
}
